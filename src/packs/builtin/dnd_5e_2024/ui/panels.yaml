panels:
  - id: sheet.header
    title: "{{ character.name || 'Adventurer' }}"
    className: "panel header"
    elements:
      - kind: text
        text: "Level {{ level }} â€¢ Proficiency +{{ prof }}"
      - kind: value
        label: "Armor Class"
        value: "{{ derived.ac }}"
      - kind: value
        label: "Initiative"
        value: "{{ derived.init }}"
      - kind: value
        label: "Speed"
        value: "{{ derived.speed }} ft"

  - id: sheet.attributes
    title: "Attributes"
    elements:
      - kind: list
        id: "attrs"
        of: "attributes"
        row:
          - kind: text
            text: "{{ item.key.toUpperCase() }}"
          - kind: value
            value: "{{ item.value }}"
          - kind: value
            label: "mod"
            value: "{{ mod(item.value) }}"
          - kind: numberInput
            id: "attr-edit"
            label: "Set"
            value: "{{ item.value }}"
            onChange:
              action: setAttribute
              key: "{{ item.key }}"

  - id: sheet.resources
    title: "Resources"
    elements:
      - kind: bar
        label: "HP"
        current: "{{ res.hp.current }}"
        max: "{{ res.hp.max }}"
        showNumbers: true
      - kind: numberInput
        id: "hp-set"
        label: "HP current"
        value: "{{ res.hp.current }}"
        onChange:
          action: setResource
          key: "hp"

  - id: sheet.derived
    title: "Combat"
    elements:
      - kind: value
        label: "Saving Throw DC"
        value: "{{ derived.save_dc }}"
      - kind: value
        label: "Passive Perception"
        value: "{{ derived.passive_perception }}"
      - kind: value
        label: "Attacks"
        value: "{{ derived.attacks_count }}"
      - kind: toggle
        id: "dbg-hex"
        label: "Hex active"
        value: "{{ !!vars.effects_hex }}"
        onChange:
          action: toggleVar
          key: "effects_hex"

  - id: sheet.actions
    title: "Actions"
    elements:
      - kind: button
        id: "btn-short"
        label: "Short Rest"
        onClick:
          action: shortRest
      - kind: button
        id: "btn-long"
        label: "Long Rest"
        onClick:
          action: longRest
      - kind: button
        id: "btn-recalc"
        label: "Recompute"
        onClick:
          action: recompute
      - kind: button
        id: "btn-test-roll"
        label: "Roll 2d6+3"
        onClick:
          action: roll
          expr: "roll('2d6+3')"

  - id: sheet.inventory
    title: "Inventory"
    elements:
      - kind: list
        id: "inv"
        of: "inventory"
        emptyText: "No items"
        row:
          - kind: text
            text: "{{ item.name }}"
          - kind: value
            value: "{{ item.tags?.join(', ') || '' }}"

  - id: sheet.controls
    title: "Controls"
    elements:
      - kind: numberInput
        id: "level"
        label: "Level"
        value: "{{ level }}"
        onChange:
          action: setLevel
